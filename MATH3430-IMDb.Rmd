---
title: "MATH3430-IMDb"
author: "MB"
date: "2025-11-19"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(readxl)
library(dplyr)
```

This is the code we used to load the oversized Excel files and clean the data that is used to create the graphs.
```
raw_basics <- read_excel("title.basics.xlsx", na = '\\N')
raw_ratings <- read_excel("title.ratings.xlsx", na = '\\N')
```
```
movie_only_basics <- raw_basics %>% 
  filter(titleType == 'movie') %>% 
  select(-endYear, -titleType, -isAdult, -originalTitle) %>% 
  rename(releaseYear = startYear)

write_xlsx(movie_only_basics, path = "movie_only_basics.xlsx")
```
```
movie_and_rating_tidy <- inner_join(raw_ratings, movie_only_basics, by = "tconst")

write_xlsx(movie_and_rating_tidy, path = "movie_and_rating_tidy.xlsx")
```
```
movie_ratings <- movie_and_rating_tidy %>% 
  select(tconst:numVotes)

write_xlsx(movie_ratings, path = "movie_ratings.xlsx")
```

